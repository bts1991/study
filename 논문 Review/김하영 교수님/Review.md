# Jean-Ho Kim†, Eun-Hong Park†, Ha Young Kim*, "Optimizing Stock Price Prediction via Macro context and Filter-DQN Framework," Journal of The Korea Society of Computer and Information (한국컴퓨터정보학회논문지), vol. 30, no. 01, Jan. 2025.(KCI).

## 한계
첫째, 국제와 국내 지표를 통합적으로 충분히 활용하지 못함
    - 한국의 KOSPI 지수는 미국, 유럽, 일본 등 주요 국제 시장의 움직임에 민감
    - 국제 시장과의 복잡한 상호작용을 충분히 반영하지 못한 채 주식 시장 내재적인 변동성만을 설명하거나 상승과 하락의 분류로 접근
둘째, 다량의 변수 중 중요한 정보를 효과적으로 선별하지 못함
    - 차원적이고 이질적인 변수들이 포함될 경우 불필요하거나 상관성이 낮은 변수로 인하여 모델의 복잡성이 증가하고 예측 성능이 저하되는 문제
    - 고차원 데이터에서 변수 선택이 이루어지지 않을 경우 과적합 위험이 존재 하며, 모델의 복잡성 증가로 인하여 학습 속도가 저하될 가능성
  
## 개선
주요 수출 대상국의 시장 동향과 국제적인 거시경제 변수를 포함
    - 국제 거시경제 지표와 주요 수출 대상국의 주식시장 지표를 포함해 다양한 변수로 구성되어 있는 데이터 셋에서 유의미한 변수를 선별
Filter-DQN 방법을 제안
    - 다변량 금융 시계열 데이터에서 상호 정보량(Mutual Information, MI)[10]을 기반으로 가장 유의미한 변수의 하위 집합을 강화 학습(Reinforcement Learning) 방식으로 찾아내는 Filter-DQN을 제안
  
## 방법론
1. 변수 간의 상호 정보를 DQN(Deep Q-Network)[11]의 에이전트(Agent)에게 보상(Reward)으로써 부여하며 학습시키는 Filter-DQN 기법을 통해 다변량 데이터에서 유의미한 변수의 하위 집합을 선별
   1. Filter-DQN Framework: 기존 필터 기법에서 활용되었던 상호 정보 이론과 DQN을 결합한 프레임워크
2. 선별된 변수들을 입력으로 활용하여 Transformer 기반 시계열 예측 모델[12-14] 을 학습시키고, 이를 통해 KOSPI 종가 지수의 변동성을 정교하게 예측
3. 절차
   1. 훈련 데이터의 무작위 시점 시계열 정보를 상태로써 입력
   2. 에이전트는 어떤 변수를 선택 할지 행동을 결정(변수의 차원을 축소)
   3. 행동에 의해 선택된 변수와 목적 변수와의 상호 정보량을 기반으로 보상을 부여
   4. 반복되며 목적 변수와 높은 상호 정보를 가지게 되는 변수들에 대한 행동 가치를 에이전트가 학습
   5. 상위 k개의 변수를 필터링하고, 이를 통해 생성된 하위 변수 집합을 출력
   6. Transformer 기반 예측 모델[12-14]에 입력되어 시간 흐름에 따른 변동성과 변수 간의 상관관계를 학습

## 기대 효과
계산 비용을 절감하고 예측 성능을 극대화

## 성능 평가
예측: 8.28%, 45.28% 향상
계산 비용: 2.6% 절감

## 나의 생각
코스피를 예측하기 위해 다양한 변수들을 고려(미국주가지수, 일본주가지수, 금가격, 원유가격등 국제적 지수 + 이동평균선 등의 기술적 지표)하였고
많은 변수 중 중요한 변수들을 유의미하게 선택하여 예측을 위한 입력으로 활용


